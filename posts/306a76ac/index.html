<!DOCTYPE html><html lang="en" class="loading"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><title>开发日志2 - Cinnabar&#39;s Blog</title><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="google" content="notranslate"><meta name="keywords" content="Cinnabar,"><meta name="description" content="先新建放着
我主要想看看开发日志1的封面


841340484181 
做了件事情
把 Camera 的位置移到了池子上沿的中点
感觉后面写左右对称的钓鱼的逻辑的时候会方便很多很多
5716242,"><meta name="author" content="Cinnabar_YF"><link rel="alternative" href="atom.xml" title="Cinnabar&#39;s Blog" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="开发日志2 - Cinnabar&#39;s Blog"><meta name="twitter:description" content="先新建放着
我主要想看看开发日志1的封面


841340484181 
做了件事情
把 Camera 的位置移到了池子上沿的中点
感觉后面写左右对称的钓鱼的逻辑的时候会方便很多很多
5716242,"><meta property="og:site_name" content="Cinnabar&#39;s Blog"><meta property="og:type" content="object"><meta property="og:title" content="开发日志2 - Cinnabar&#39;s Blog"><meta property="og:description" content="先新建放着
我主要想看看开发日志1的封面


841340484181 
做了件事情
把 Camera 的位置移到了池子上沿的中点
感觉后面写左右对称的钓鱼的逻辑的时候会方便很多很多
5716242,"><link rel="stylesheet" href="/css/diaspora.css"><script>window.searchDbPath="/search.xml"</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet"><meta name="generator" content="Hexo 5.4.2"></head><body class="loading"><span id="config-title" style="display:none">Cinnabar&#39;s Blog</span><div id="loader"></div><div id="single"><div id="top" style="display:block"><div class="bar" style="width:0"></div><a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://cinnabar.icu"></a><div title="播放/暂停" class="iconfont icon-play"></div><h3 class="subtitle">开发日志2</h3><div class="social"><div><div class="share"><a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a></div><div id="qr"></div></div></div><div class="scrollbar"></div></div><div class="section"><div class="article"><div class="main"><h1 class="title">开发日志2</h1><div class="stuff"><span>创建于：八月 07, 2022</span> <span>最后更新于：八月 17, 2022</span><ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li></ul></div><div class="content markdown"><p><del>先新建放着</del></p><p><del>我主要想看看开发日志1的封面</del></p><img src="//pic.imgdb.cn/item/62f0fedb16f2c2beb18974b6.gif" width="30%" style="margin-bottom:20px"><p><button class="liquid"><span>841340484181</span><div class="liquid"></div></button></p><p>做了件事情</p><p>把 Camera 的位置移到了池子上沿的中点</p><p>感觉后面写左右对称的钓鱼的逻辑的时候会方便很多很多</p><p><button class="liquid"><span>571624202280</span><div class="liquid"></div></button></p><p>突然想到个问题：鱼会向后游嘛</p><p>感觉没见过有丶反直觉</p><p>于是去问了问神奇海螺</p><h3 id="鱼会不会倒着游？"><a href="#鱼会不会倒着游？" class="headerlink" title="鱼会不会倒着游？"></a>鱼会不会倒着游？</h3><p>倒着游分为两种：一种是向后游，一种是仰泳</p><blockquote><p>蝴蝶鱼的尾部或背鳍上通常有一个斑点，这是它们的“假眼”而它们真正的眼睛隐藏在头部的黑色条纹中，不易被发现。蝴蝶鱼倒着游时，能让敌人误以为它们的尾巴是头。当敌人发起攻击时，它们一摇尾巴就可以很快地逃走了。</p></blockquote><blockquote><p>一般中、大型鱼和一些小型鱼，比如像孔雀鱼这样的卵胎生鱼类，在追求异性的时候会向后游，大型鱼在打架时也会倒游，但是不能一直倒游，只能向后一小段距离<br>有一种热带鱼，叫反游猫，可以肚皮朝上游，但在大多时候还是和正常鱼一样肚皮朝下游。</p></blockquote><hr><p>感觉有些东西还是有必要记录一下的</p><p>于是随手搞了个新玩意</p><p>嘻嘻</p><p>模板：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;liquid&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>xxxxxxxx<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;liquid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><p><button class="liquid"><span>xxxxxxxx</span><div class="liquid"></div></button></p><p>顺便记录一下最强插件的一些骚操作</p><ol><li><p>虽然我看不懂但好像没有问题</p><img src="./copilot1.png"></li><li><p>以后我一定好好写注释</p><img src="./copilot2.png"></li><li><p>当我又好像不需要写注释</p><img src="./copilot4.png"></li><li><p>一个优秀的代码决不允许8层 if 嵌套</p><img src="//pic.imgdb.cn/item/62fba74c16f2c2beb1201eb2.png"></li><li><p>究竟想要 Remove 什么东西</p><img src="//pic.imgdb.cn/item/62fba74c16f2c2beb1201eb5.png"><p>&lt; 未完待续 &gt;</p></li></ol><p>回归正题</p><p>好像在<a href="/posts/a9632716/" title="开发日志1">开发日志1</a>中都没提到游戏的玩法</p><p>首先这是一个弹幕互动游戏，所以必须要考虑到直播延迟的问题</p><p>一般正常延迟在 5s 左右吧</p><p>游戏核心分成两部分：抛竿和提竿</p><p>一杯茶一包烟，一根鱼竿钓一天</p><p><del>钓鱼佬的鱼都从菜市场买来的</del></p><p>当然不能做成抛完杆然后每隔一小时来看一下鱼有没有上钩</p><p>但我也不想做成抛完杆 Random.Value &lt; 0.1 ? “鱼上钩了” : “鱼不见了”</p><p>所以最终通过发送角度来控制抛竿的方向，其中会有延迟和风速的叠加影响</p><p>至于角度会在每条鱼的上方进行辅助显示</p><p>虽然但是这更像插鱼或者是黄金矿工，但至少从一成品来看还行</p><p>鱼上钩之后要开始和鱼拉扯</p><p>每条鱼会有若干不同的规则</p><p>每个玩家会有若干骰子</p><p>每隔一段时间会掷骰子</p><p>然后根据规则计算骰子所对应的点数，以此作为拉力</p><p>当然如果线断了那鱼就跑了</p><p><del>一起加油努力钓鱼吧，各种成就奖励等你来发现</del></p><p>至于在<a href="/posts/a9632716/" title="开发日志1">开发日志1</a>中提到的鱼王相关的部分当然是咕咕咕到开发日志3中</p><p><button class="liquid"><span>562993211210</span><div class="liquid"></div></button></p><p>记录一个鬼故事，可能哪天又会重现于世</p><p>在掷骰子后需要根据结果设置鱼的速度</p><p>运行时有一次一条鱼宛如死鱼一样一动不动</p><p>观察发现在速度设置完后极短时间被一股神秘力量归零了…</p><p>将可能的地方都打上断点进行测试</p><p>一个都没有触发…</p><p>然后重开了测试之后再也没有碰到了…</p><p><code>每次 git commit 时候看到被修改的文件都有几十个总觉得自己做了很多事，谢谢 Unity</code></p><p><button class="liquid"><span>562892492624</span><div class="liquid"></div></button></p><p>终于在若干天前完成了 v0.0.1 版本的测试</p><p>直播测试达到了预期的效果，光荣下播</p><p><code>噜噜噜，啊哇哇</code></p><p>这里记录一下目前为止实现了一些什么功能</p><ol><li><br><br><br><br><br><br><br><br><br><br><br><br><span style="color:#fff">提笔又止</span><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><span style="color:#fff">提笔㕛止</span><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><span style="color:#fff">提笔叒止</span><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><span style="color:#fff">提笔叕止</span><br><br><br><br><br><br><br><br><br><br><br><br><br><br></li></ol><p>啊我不想写</p><hr><p>为什么 FF14 的房子只有 400 个家具位</p><p>不想封层</p><p>稍微设计下 400 个家具位就没了</p><p>房子不想装修 日志不想记录</p><p>怕不是得了<hide>电子阳痿</hide></p><details><summary>那贴一张图吧</summary><img src="//pic.imgdb.cn/item/62fc93db16f2c2beb1820c9a.png"></details><p>这张纸包含了整个项目最难的部分</p><p>如何将错综复杂的规则有一种比较优雅的方式用一种统一的方式存在一张表里</p><p>规则包括但不限于：相同，不同，存在，不存在，大于，小于，总和，指定区域等等以及它们的组合</p><p>最终设计用了 <code>8</code> 个字段来实现了对 95% 规则的统一描述</p><p>CheckRule 函数只有 104 行</p><p>当时写完测试完修完 bug 之后我以为整个项目中的难点已经过去了</p><p>但其实噩梦才刚刚开始</p><blockquote><p>建议到百万数据的时候再考虑这个问题</p></blockquote><p>9个骰子一共有 <code>10077696</code> 种组合</p><p>对于某一种组合判断是否满足规则很简单</p><p>但要找出符合符合一条规则的所有组合却很难</p><p>因而评判多条规则之间的耦合程度（同时满足多条规则的组合的加权和）更是难上加难</p><p>有两种解决方法：</p><ol><li><p>按规则分类每种规则写一套求解方法</p><p>优点：在写求解代码的时候规则有直观的表示，并且可以根据每大类的特点进行优化求解思路，从而达到更快的求解速度</p><p>缺点：需要先对规则进行分类，代码量相比第二种会大很多（我觉得），后期每次加入新规则都需要进行维护扩写新分支</p></li><li><p>硬着头皮逆向一套求解方法适用所有规则</p><p>优点：一次写完终身受益<hide>这一条还不够嘛</hide></p><p>缺点：我是谁，我在写什么，我要写什么，我为什么这么写。所有逻辑顺序全靠脑补，debug 困难，多重嵌套（嵌中嵌中嵌）</p></li></ol><p>可想而知我选择了<hide>第二条路</hide></p><p>于是就小手一抖敲了 500+ 行代码</p><p>其中最多的地方是 11 层嵌套</p><pre>                                                    tempSum += diceBase[scopeDiceList[j]] * (tempList[j] - 1);</pre><p>体会一下这个缩进…</p><p>至此规则部分只剩下最后一块碎片没有完成了</p><p>如何分配超额完成每条规则后的额外奖励系数以及在规则抽选时候的耦合系数的阈值设定</p><p>暂时还没有想到很好的方法</p><p>所以就去 ff14 里设计装修了</p><p>设计了一套整体主题为迷宫的装修</p><p>为了有效利用空间并有充实的内容</p><p>400 个家具位基本都用完了才勉勉强强完成雏形</p><p>其中包括两个主谜题区和三个艺术区</p><p>要精装修是不可能了</p><p>个人还是挺喜欢的</p><p>虽然但是不能精装修有丶可惜</p><p>还在纠结要不要换个主题封个层</p><p>纠 <span style="font-size:50px;color:red;position:relative;top:5px;margin:0 -10px">大</span> 结</p><p><hide>感觉这个项目也许可能大概要暂时停摆一段时间了</hide></p><!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]--><audio id="audio" loop preload="auto" controls data-autoplay="false"><source type="audio/mpeg" src=""></audio><ul id="audio-list" style="display:none"><li title="0" data-url="http://link.hhtjim.com/163/425570952.mp3"></li><li title="1" data-url="http://link.hhtjim.com/163/425570952.mp3"></li></ul></div><div id="gitalk-container" class="comment link" data-enable="false" data-ae="false" data-ci="" data-cs="" data-r="" data-o="" data-a="" data-d="false">查看评论</div></div></div></div></div></body><script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/parallax/3.1.0/parallax.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.11/typed.min.js"></script><script src="/js/diaspora.js"></script><script src="/js/plugin.js"></script><link rel="stylesheet" href="//cdn.bootcdn.net/ajax/libs/photoswipe/4.1.2/photoswipe.min.css"><link rel="stylesheet" href="//cdn.bootcdn.net/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css"><script src="//cdn.bootcdn.net/ajax/libs/photoswipe/4.1.2/photoswipe.min.js"></script><script src="//cdn.bootcdn.net/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js"></script><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></html>